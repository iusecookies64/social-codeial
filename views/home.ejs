<link rel="stylesheet" href="/css/home.css" />

<div id="background-image-container"></div>
<div id="background-image-overlay"></div>

<main>
  <!-- Post Form Below -->

  <!-- Show post form if user logged in -->
  <% if(locals.user) {%>
  <div id="create-post-form">
    <h2>Create A Post</h2>
    <form action="/posts/create" method="POST">
      <textarea
        name="content"
        cols="30"
        rows="10"
        placeholder="Type Here..."
      ></textarea>
      <input type="submit" value="Add Post" />
    </form>
  </div>
  <%} %>

  <!-- Post list container below -->

  <div id="posts-list-container">
    <h2>Posts By Our Users</h2>
    <ul>
      <% for(post of posts) { %>
      <li class="post-list-item">
        <!-- post content along with user name -->
        <p>
          âž¡ <%= post.content %> :
          <small> <%= post.user.name %> </small>
        </p>
        <!-- Each post will have a comment form of its own -->
        <!-- this form is visible only to logged in user -->
        <% if(locals.user) { %>
        <form action="/comments/create" method="POST">
          <input
            type="text"
            name="content"
            placeholder="Type Comment Here..."
          />
          <!-- post id is sent in hidden way -->
          <input type="hidden" name="post" value="<%= post._id %>" />
          <input type="submit" value="Add Comment" />
        </form>
        <% } %>

        <!-- Showing comments for this post -->
        <div id="comment-list-container">
          <h3>Comments</h3>
          <ul id="post-comments-<%= post._id %> ">
            <!-- for loop for looping over each comment -->

            <% for(comment of post.comments) {%>
            <li>
              <p>
                <%= comment.content %>
                <small> <%= comment.user.name%> </small>
              </p>
            </li>
            <% } %>
          </ul>
        </div>
      </li>

      <% } %>
    </ul>
  </div>
</main>
